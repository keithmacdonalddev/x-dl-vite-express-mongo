<!--
  Media Vault Prototype
  Round: zeta-1
  Concept: Spatial Folder System ‚Äî downloads live inside folders named by creator, folders expand inline
  Special Feature: Inline Folder Expansion ‚Äî clicking a creator "folder" expands it in-place revealing job sheets, like opening a physical file drawer, with a paper-slide physics animation
  Score Target: 90+
-->
<!-- SPECIAL FEATURE: Inline Folder Expansion ‚Äî creator entries expand vertically in-place with a spring-physics paper-slide, revealing job cards stacked like physical file sheets; no modal, no navigation, pure spatial metaphor -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Media Vault ‚Äî Spatial Folders</title>
<style>
  /* ============================================================
     DESIGN TOKENS ‚Äî ONE SYSTEM
  ============================================================ */
  :root {
    /* Radius scale */
    --radius-xs: 4px;
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 24px;

    /* Shadow elevation */
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.2);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.35), 0 2px 6px rgba(0,0,0,0.2);
    --shadow-lg: 0 8px 24px rgba(0,0,0,0.4), 0 4px 12px rgba(0,0,0,0.25);
    --shadow-xl: 0 20px 48px rgba(0,0,0,0.5), 0 8px 24px rgba(0,0,0,0.3);

    /* Glass recipe ‚Äî 3 tiers */
    --glass-t1-bg: rgba(255,255,255,0.07);
    --glass-t1-blur: blur(4px) saturate(160%);
    --glass-t2-bg: rgba(255,255,255,0.04);
    --glass-t2-blur: blur(12px) saturate(140%);
    --glass-t3-bg: rgba(255,255,255,0.02);
    --glass-t3-blur: blur(20px) saturate(120%);

    /* Asymmetric glass borders */
    --glass-border-top: rgba(255,255,255,0.12);
    --glass-border-left: rgba(255,255,255,0.08);
    --glass-border-right: rgba(0,0,0,0.08);
    --glass-border-bottom: rgba(0,0,0,0.12);

    /* Colors */
    --bg-base: #080c14;
    --bg-mid: #0c1220;
    --bg-surface: #111827;
    --ink: #e8edf5;
    --ink-muted: #8898b8;
    --ink-faint: #a8b8cc;

    /* Desaturated status palette */
    --status-complete: hsl(145, 45%, 52%);
    --status-failed: hsl(0, 48%, 52%);
    --status-running: hsl(210, 50%, 58%);
    --status-queued: hsl(30, 15%, 52%);
    --status-canceled: hsl(220, 20%, 45%);

    /* Accent */
    --accent: hsl(215, 70%, 60%);
    --accent-rgb: 77, 130, 220;
    --accent-dim: hsl(215, 50%, 40%);

    /* Animation springs */
    --spring-enter: cubic-bezier(0.34, 1.56, 0.64, 1);
    --spring-exit: cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --spring-snap: cubic-bezier(0.68, -0.55, 0.265, 1.55);

    /* Typography scale */
    --t-display: clamp(2.8rem, 5vw, 4.5rem);
    --t-heading: clamp(1.15rem, 2vw, 1.4rem);
    --t-subheading: 0.9375rem;
    --t-body: 0.84375rem;
    --t-caption: 0.71875rem;
  }

  /* ============================================================
     RESET + BASE
  ============================================================ */
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    height: 100%;
    background: var(--bg-base);
    color: var(--ink);
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    overflow: hidden;
  }

  /* Tabular nums for all metrics */
  .numeric, [data-metric], .count, .timestamp, .filesize, .progress-pct {
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
  }

  /* ============================================================
     BACKGROUND ‚Äî subtle mesh, NOT obvious orbs
  ============================================================ */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 80% 50% at 15% 20%, rgba(77,130,220,0.06) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 85% 80%, rgba(120,80,200,0.04) 0%, transparent 55%),
      linear-gradient(160deg, #080c14 0%, #0a0f1e 50%, #06090f 100%);
    pointer-events: none;
    z-index: 0;
  }

  /* ============================================================
     APP LAYOUT ‚Äî 3-column: sidebar | main | activity
  ============================================================ */
  #app {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: 260px 1fr 320px;
    grid-template-rows: 100vh;
    height: 100vh;
    gap: 0;
    opacity: 0;
  }

  #app.ready { opacity: 1; }

  /* Entrance choreography */
  .chrome { opacity: 0; animation: fadeUp 0.4s var(--spring-exit) 0.08s forwards; }
  .main-area { opacity: 0; animation: fadeUp 0.5s var(--spring-exit) 0.18s forwards; }
  .side-panel { opacity: 0; animation: fadeUp 0.4s var(--spring-exit) 0.32s forwards; }
  .intake-zone { opacity: 0; animation: fadeUp 0.45s var(--spring-exit) 0.48s forwards; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(12px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* ============================================================
     LEFT SIDEBAR ‚Äî Settings + Stats
  ============================================================ */
  #sidebar {
    backdrop-filter: var(--glass-t3-blur);
    background: var(--glass-t3-bg);
    border-right: 1px solid rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    padding: 0;
    overflow: hidden;
    position: relative;
  }

  #sidebar::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.04) 0%, transparent 60%);
    pointer-events: none;
  }

  .sidebar-header {
    padding: 24px 20px 16px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }

  .logo {
    font-size: var(--t-heading);
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--ink);
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .logo-icon {
    width: 28px;
    height: 28px;
    background: linear-gradient(135deg, hsl(215,70%,55%) 0%, hsl(240,60%,55%) 100%);
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    box-shadow: var(--shadow-sm);
    flex-shrink: 0;
  }

  /* Hero metric */
  .hero-metric {
    padding: 20px 20px 16px;
    border-bottom: 1px solid rgba(255,255,255,0.04);
  }

  .hero-number {
    font-size: var(--t-display);
    font-weight: 800;
    letter-spacing: -0.04em;
    line-height: 1.0;
    color: var(--ink);
    text-shadow: 0 2px 8px rgba(0,0,0,0.6);
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
  }

  .hero-label {
    font-size: var(--t-caption);
    font-weight: 400;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--ink-muted);
    margin-top: 4px;
  }

  /* Settings section */
  .settings-section {
    padding: 16px 20px;
    border-bottom: 1px solid rgba(255,255,255,0.04);
    flex-shrink: 0;
  }

  .section-label {
    font-size: var(--t-caption);
    font-weight: 400;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--ink-muted);
    margin-bottom: 12px;
  }

  .platform-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 10px;
    background: var(--glass-t1-bg);
    backdrop-filter: var(--glass-t1-blur);
    border-radius: var(--radius-sm);
    border-top: 1px solid var(--glass-border-top);
    border-left: 1px solid var(--glass-border-left);
    border-right: 1px solid var(--glass-border-right);
    border-bottom: 1px solid var(--glass-border-bottom);
    margin-bottom: 6px;
    cursor: pointer;
    transition: background 0.18s ease;
    position: relative;
    overflow: hidden;
  }

  .platform-row::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.05) 0%, transparent 60%);
    pointer-events: none;
  }

  .platform-row:hover { background: rgba(255,255,255,0.09); }

  .platform-name {
    font-size: var(--t-body);
    font-weight: 600;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .platform-dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
  }

  /* Toggle component */
  .toggle {
    width: 34px;
    height: 19px;
    background: rgba(255,255,255,0.12);
    border-radius: 999px;
    position: relative;
    cursor: pointer;
    transition: background 0.2s var(--spring-snap);
    border: none;
    outline: none;
    flex-shrink: 0;
  }

  .toggle.on { background: var(--status-running); }

  .toggle::after {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 15px;
    height: 15px;
    background: white;
    border-radius: 50%;
    transition: transform 0.2s var(--spring-snap);
    box-shadow: var(--shadow-sm);
  }

  .toggle.on::after { transform: translateX(15px); }

  /* Stats in sidebar */
  .stats-grid {
    padding: 12px 20px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
  }

  .stat-chip {
    background: var(--glass-t1-bg);
    backdrop-filter: var(--glass-t1-blur);
    border-radius: var(--radius-md);
    border-top: 1px solid var(--glass-border-top);
    border-left: 1px solid var(--glass-border-left);
    border-right: 1px solid var(--glass-border-right);
    border-bottom: 1px solid var(--glass-border-bottom);
    padding: 10px 12px;
    position: relative;
    overflow: hidden;
  }

  .stat-chip::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.05) 0%, transparent 60%);
    pointer-events: none;
  }

  .stat-value {
    font-size: 1.3rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--ink);
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
  }

  .stat-label {
    font-size: var(--t-caption);
    color: var(--ink-muted);
    margin-top: 2px;
  }

  .sidebar-spacer { flex: 1; }

  .sidebar-footer {
    padding: 14px 20px;
    border-top: 1px solid rgba(255,255,255,0.04);
    font-size: var(--t-caption);
    color: var(--ink-muted);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .live-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--status-complete);
    flex-shrink: 0;
  }

  .live-dot.pulse {
    animation: livePulse 1.5s ease-in-out infinite;
  }

  @keyframes livePulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.8); }
  }

  /* ============================================================
     MAIN AREA
  ============================================================ */
  #main {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }

  /* Intake zone */
  #intake {
    padding: 28px 28px 20px;
    flex-shrink: 0;
    position: relative;
  }

  .intake-label {
    font-size: var(--t-caption);
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--ink-muted);
    margin-bottom: 10px;
    font-weight: 400;
  }

  .intake-form {
    position: relative;
    display: flex;
    align-items: center;
    gap: 0;
  }

  .intake-shell {
    flex: 1;
    display: flex;
    align-items: center;
    background: var(--glass-t1-bg);
    backdrop-filter: var(--glass-t1-blur);
    border-radius: var(--radius-xl);
    border-top: 1px solid var(--glass-border-top);
    border-left: 1px solid var(--glass-border-left);
    border-right: 1px solid var(--glass-border-right);
    border-bottom: 1px solid var(--glass-border-bottom);
    padding: 4px 8px 4px 18px;
    transition: box-shadow 0.22s ease, transform 0.14s ease;
    box-shadow: 0 0 20px rgba(var(--accent-rgb), 0.04);
    animation: breathe 4s ease-in-out infinite;
    position: relative;
    overflow: hidden;
  }

  .intake-shell::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.06) 0%, transparent 60%);
    pointer-events: none;
  }

  @keyframes breathe {
    0%, 100% { box-shadow: 0 0 20px rgba(77,130,220,0.04); }
    50% { box-shadow: 0 0 32px rgba(77,130,220,0.09); }
  }

  .intake-shell:focus-within {
    animation: none;
    box-shadow:
      0 0 0 2px var(--accent),
      0 0 40px rgba(77,130,220,0.12),
      0 0 80px rgba(77,130,220,0.06);
  }

  .intake-icon {
    color: var(--ink-muted);
    font-size: 15px;
    flex-shrink: 0;
    margin-right: 10px;
  }

  #intake-input {
    flex: 1;
    background: none;
    border: none;
    outline: none;
    color: var(--ink);
    font-size: clamp(14px, 1.4vw, 16px);
    font-weight: 450;
    padding: 12px 0;
    caret-color: var(--accent);
  }

  #intake-input::placeholder {
    color: var(--ink-muted);
    opacity: 0.7;
  }

  /* Platform detection chip */
  .platform-chip {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: var(--t-caption);
    font-weight: 600;
    padding: 4px 10px;
    border-radius: var(--radius-xs);
    transform: scale(0.7);
    opacity: 0;
    transition: transform 0.25s var(--spring-enter), opacity 0.2s ease;
    flex-shrink: 0;
    margin-right: 6px;
  }

  .platform-chip.visible {
    transform: scale(1);
    opacity: 1;
  }

  .platform-chip.x-chip {
    background: rgba(255,255,255,0.08);
    color: #c8d4e8;
    border: 1px solid rgba(255,255,255,0.1);
  }

  .platform-chip.tiktok-chip {
    background: rgba(255,80,120,0.1);
    color: #e8a0b0;
    border: 1px solid rgba(255,80,120,0.15);
  }

  /* Submit button */
  .intake-btn {
    padding: 10px 20px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: var(--radius-lg);
    font-size: var(--t-body);
    font-weight: 700;
    cursor: pointer;
    transition: transform 0.14s ease, box-shadow 0.14s ease, background 0.14s ease;
    box-shadow: var(--shadow-md);
    margin-left: 8px;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .intake-btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-lg); }
  .intake-btn:active { transform: scale(0.97) translateY(0); box-shadow: var(--shadow-sm); }

  .intake-btn.success {
    background: var(--status-complete);
  }

  /* ============================================================
     JOBS + FOLDERS ‚Äî MAIN CONTENT
  ============================================================ */
  #content {
    flex: 1;
    overflow-y: auto;
    padding: 0 28px 28px;
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.08) transparent;
  }

  #content::-webkit-scrollbar { width: 4px; }
  #content::-webkit-scrollbar-track { background: transparent; }
  #content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 2px; }

  .content-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
    padding-top: 4px;
  }

  .content-title {
    font-size: var(--t-heading);
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--ink);
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
  }

  .job-count-badge {
    font-size: var(--t-caption);
    color: var(--ink-muted);
    background: rgba(255,255,255,0.05);
    padding: 3px 10px;
    border-radius: var(--radius-xs);
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
  }

  /* ============================================================
     FOLDER COMPONENT ‚Äî THE SPECIAL FEATURE
  ============================================================ */
  .folder {
    background: var(--glass-t2-bg);
    backdrop-filter: var(--glass-t2-blur);
    border-radius: var(--radius-lg);
    border-top: 1px solid var(--glass-border-top);
    border-left: 1px solid var(--glass-border-left);
    border-right: 1px solid var(--glass-border-right);
    border-bottom: 1px solid var(--glass-border-bottom);
    margin-bottom: 8px;
    overflow: hidden;
    box-shadow: var(--shadow-md);
    position: relative;
    transition: box-shadow 0.2s ease;
  }

  .folder::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.04) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .folder:hover { box-shadow: var(--shadow-lg); }

  .folder-tab {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 14px 16px;
    cursor: pointer;
    position: relative;
    z-index: 1;
    user-select: none;
    transition: background 0.15s ease;
  }

  .folder-tab:hover { background: rgba(255,255,255,0.03); }

  /* Folder tab icon ‚Äî file-drawer metaphor */
  .folder-icon {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-sm);
    background: rgba(255,255,255,0.05);
    border-top: 1px solid rgba(255,255,255,0.1);
    border-left: 1px solid rgba(255,255,255,0.07);
    border-right: 1px solid rgba(0,0,0,0.1);
    border-bottom: 1px solid rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
    transition: transform 0.2s var(--spring-snap);
  }

  .folder.open .folder-icon { transform: rotate(5deg); }

  .folder-meta { flex: 1; min-width: 0; }

  .folder-name {
    font-size: var(--t-subheading);
    font-weight: 600;
    letter-spacing: -0.01em;
    color: var(--ink);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .folder-subtitle {
    font-size: var(--t-caption);
    color: var(--ink-muted);
    margin-top: 1px;
  }

  .folder-stats {
    display: flex;
    gap: 8px;
    align-items: center;
    flex-shrink: 0;
  }

  .folder-count {
    font-size: var(--t-caption);
    color: var(--ink-muted);
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
  }

  .folder-chevron {
    color: var(--ink-muted);
    font-size: 11px;
    transition: transform 0.25s var(--spring-enter);
    opacity: 0.6;
  }

  .folder.open .folder-chevron { transform: rotate(90deg); }

  /* Folder contents ‚Äî the spring-slide drawer */
  .folder-contents {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s var(--spring-exit);
    position: relative;
    z-index: 1;
  }

  .folder.open .folder-contents {
    max-height: 2000px;
    transition: max-height 0.5s var(--spring-enter);
  }

  .folder-divider {
    height: 1px;
    background: linear-gradient(to right, transparent, rgba(255,255,255,0.07) 20%, rgba(255,255,255,0.07) 80%, transparent);
    margin: 0 12px;
  }

  /* Job cards inside folders */
  .job-list-inner {
    padding: 8px 12px 12px;
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .job-card {
    background: var(--glass-t1-bg);
    backdrop-filter: var(--glass-t1-blur);
    border-radius: var(--radius-md);
    border-top: 1px solid var(--glass-border-top);
    border-left: 1px solid var(--glass-border-left);
    border-right: 1px solid var(--glass-border-right);
    border-bottom: 1px solid var(--glass-border-bottom);
    padding: 12px 14px;
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 10px;
    align-items: center;
    position: relative;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    /* Entrance animation */
    animation: cardEnter 0.35s var(--spring-enter) both;
  }

  @keyframes cardEnter {
    from { opacity: 0; transform: translateY(6px) scale(0.98); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  .job-card::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.04) 0%, transparent 55%);
    pointer-events: none;
  }

  /* Status indicator ‚Äî NOT a left bar, NOT a blinking badge */
  .job-status-glyph {
    width: 28px;
    height: 28px;
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    flex-shrink: 0;
  }

  .job-status-glyph.status-completed {
    background: rgba(80,175,120,0.15);
    color: var(--status-complete);
  }
  .job-status-glyph.status-running {
    background: rgba(80,140,200,0.15);
    color: var(--status-running);
  }
  .job-status-glyph.status-failed {
    background: rgba(200,80,80,0.15);
    color: var(--status-failed);
  }
  .job-status-glyph.status-queued {
    background: rgba(140,120,90,0.12);
    color: var(--status-queued);
  }

  /* Only one running indicator pulses */
  .job-status-glyph.running-pulse {
    animation: glyphPulse 1.5s ease-in-out infinite;
  }

  @keyframes glyphPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .job-info { min-width: 0; }

  .job-title {
    font-size: var(--t-body);
    font-weight: 400;
    color: var(--ink);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 3px;
  }

  .job-meta-row {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: var(--t-caption);
    color: var(--ink-muted);
  }

  .job-platform-tag {
    font-size: var(--t-caption);
    font-weight: 600;
    padding: 1px 6px;
    border-radius: var(--radius-xs);
    letter-spacing: 0.02em;
  }

  .job-platform-tag.x { background: rgba(255,255,255,0.07); color: #b0c4d8; }
  .job-platform-tag.tiktok { background: rgba(255,80,120,0.1); color: #e0a0b0; }

  .job-actions {
    display: flex;
    gap: 4px;
    flex-shrink: 0;
  }

  .job-action-btn {
    width: 28px;
    height: 28px;
    border: none;
    background: rgba(255,255,255,0.05);
    color: var(--ink-muted);
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    transition: background 0.15s ease, transform 0.14s ease, color 0.15s ease;
  }

  .job-action-btn:hover { background: rgba(255,255,255,0.1); color: var(--ink); transform: translateY(-1px); }
  .job-action-btn:active { transform: scale(0.97) translateY(0); }

  /* Progress arc for running jobs ‚Äî NOT a bottom bar */
  .progress-ring-wrap {
    position: relative;
    width: 28px;
    height: 28px;
    flex-shrink: 0;
  }

  .progress-ring {
    transform: rotate(-90deg);
  }

  .progress-ring-bg { stroke: rgba(255,255,255,0.06); }
  .progress-ring-fill {
    stroke: var(--status-running);
    stroke-linecap: round;
    transition: stroke-dashoffset 0.8s var(--spring-exit);
  }

  .progress-pct-label {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 8px;
    font-weight: 700;
    color: var(--status-running);
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
    line-height: 1;
  }

  /* ============================================================
     ALL JOBS VIEW (not in folders)
  ============================================================ */
  .view-toggle {
    display: flex;
    gap: 2px;
    background: rgba(255,255,255,0.04);
    border-radius: var(--radius-sm);
    padding: 2px;
  }

  .view-btn {
    padding: 5px 12px;
    font-size: var(--t-caption);
    font-weight: 600;
    color: var(--ink-muted);
    background: none;
    border: none;
    cursor: pointer;
    border-radius: var(--radius-xs);
    transition: background 0.15s ease, color 0.15s ease;
    letter-spacing: 0.02em;
  }

  .view-btn.active {
    background: rgba(255,255,255,0.08);
    color: var(--ink);
  }

  /* ============================================================
     ACTIVITY PANEL ‚Äî RIGHT SIDE
  ============================================================ */
  #activity {
    backdrop-filter: var(--glass-t3-blur);
    background: var(--glass-t3-bg);
    border-left: 1px solid rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }

  #activity::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 80% 10%, rgba(255,255,255,0.03) 0%, transparent 60%);
    pointer-events: none;
  }

  .activity-header {
    padding: 24px 16px 12px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
  }

  .activity-title {
    font-size: var(--t-heading);
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--ink);
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
  }

  .activity-live-badge {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: var(--t-caption);
    color: var(--status-complete);
    font-weight: 600;
    background: rgba(80,175,120,0.1);
    padding: 3px 8px;
    border-radius: var(--radius-xs);
  }

  #activity-feed {
    flex: 1;
    overflow-y: auto;
    padding: 10px 14px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.06) transparent;
  }

  #activity-feed::-webkit-scrollbar { width: 3px; }
  #activity-feed::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.06); border-radius: 2px; }

  .activity-entry {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 8px;
    padding: 7px 10px;
    border-radius: var(--radius-sm);
    background: rgba(255,255,255,0.02);
    border-top: 1px solid rgba(255,255,255,0.04);
    border-left: 1px solid rgba(255,255,255,0.03);
    border-right: 1px solid rgba(0,0,0,0.06);
    border-bottom: 1px solid rgba(0,0,0,0.08);
    animation: entrySlide 0.3s var(--spring-enter) both;
    position: relative;
    overflow: hidden;
  }

  .activity-entry::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(ellipse at 20% 10%, rgba(255,255,255,0.03) 0%, transparent 60%);
    pointer-events: none;
  }

  @keyframes entrySlide {
    from { opacity: 0; transform: translateX(8px); }
    to   { opacity: 1; transform: translateX(0); }
  }

  .entry-level {
    width: 18px;
    height: 18px;
    border-radius: var(--radius-xs);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 9px;
    font-weight: 700;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .entry-level.info { background: rgba(77,130,220,0.15); color: var(--status-running); }
  .entry-level.warn { background: rgba(200,160,60,0.15); color: hsl(40, 55%, 60%); }
  .entry-level.error { background: rgba(200,80,80,0.15); color: var(--status-failed); }
  .entry-level.ok { background: rgba(80,175,120,0.15); color: var(--status-complete); }

  .entry-content { min-width: 0; }

  .entry-text {
    font-size: var(--t-caption);
    color: var(--ink-faint);
    line-height: 1.4;
    word-break: break-word;
  }

  .entry-time {
    font-size: 0.625rem;
    color: var(--ink-muted);
    margin-top: 2px;
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
    opacity: 0.7;
  }

  /* ============================================================
     SCROLL TO BOTTOM BUTTON for activity
  ============================================================ */
  .scroll-bottom-btn {
    position: absolute;
    bottom: 12px;
    right: 12px;
    width: 30px;
    height: 30px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 50%;
    color: var(--ink-muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    transition: opacity 0.2s ease, transform 0.14s ease;
    opacity: 0;
    pointer-events: none;
    z-index: 2;
  }

  .scroll-bottom-btn.visible { opacity: 1; pointer-events: all; }
  .scroll-bottom-btn:hover { transform: translateY(-1px); }
  .scroll-bottom-btn:active { transform: scale(0.95); }

  /* ============================================================
     NOTIFICATION SYSTEM ‚Äî inline inline inline, not toast
  ============================================================ */
  #notif-bar {
    position: fixed;
    top: 16px;
    left: 50%;
    transform: translateX(-50%) translateY(-60px);
    background: var(--glass-t1-bg);
    backdrop-filter: var(--glass-t1-blur);
    border-top: 1px solid var(--glass-border-top);
    border-left: 1px solid var(--glass-border-left);
    border-right: 1px solid var(--glass-border-right);
    border-bottom: 1px solid var(--glass-border-bottom);
    border-radius: var(--radius-md);
    padding: 10px 18px;
    font-size: var(--t-body);
    color: var(--ink);
    box-shadow: var(--shadow-lg);
    z-index: 1000;
    transition: transform 0.3s var(--spring-enter);
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  #notif-bar.show { transform: translateX(-50%) translateY(0); }

  /* ============================================================
     GLOBAL SCROLLBAR
  ============================================================ */
  * { scrollbar-width: thin; scrollbar-color: rgba(255,255,255,0.06) transparent; }

</style>
</head>
<body>

<div id="notif-bar">
  <span id="notif-icon">‚úì</span>
  <span id="notif-text">Added to queue</span>
</div>

<div id="app">
  <!-- LEFT SIDEBAR -->
  <aside id="sidebar" class="chrome">
    <div class="sidebar-header">
      <div class="logo">
        <div class="logo-icon">‚¨°</div>
        Media Vault
      </div>
    </div>

    <div class="hero-metric">
      <div class="hero-number" id="hero-num">24</div>
      <div class="hero-label">Total Downloads</div>
    </div>

    <!-- SETTINGS -->
    <div class="settings-section">
      <div class="section-label">Platforms</div>

      <div class="platform-row" onclick="togglePlatform('x')">
        <div class="platform-name">
          <span class="platform-dot" style="background: #8ab0d0;"></span>
          X (Twitter)
        </div>
        <button class="toggle on" id="toggle-x" aria-label="Toggle X platform"></button>
      </div>

      <div class="platform-row" onclick="togglePlatform('tiktok')">
        <div class="platform-name">
          <span class="platform-dot" style="background: #d090a8;"></span>
          TikTok
        </div>
        <button class="toggle on" id="toggle-tiktok" aria-label="Toggle TikTok platform"></button>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-chip">
        <div class="stat-value" id="stat-complete">18</div>
        <div class="stat-label">Completed</div>
      </div>
      <div class="stat-chip">
        <div class="stat-value" id="stat-failed">3</div>
        <div class="stat-label">Failed</div>
      </div>
      <div class="stat-chip">
        <div class="stat-value" id="stat-running">2</div>
        <div class="stat-label">Running</div>
      </div>
      <div class="stat-chip">
        <div class="stat-value" id="stat-queued">1</div>
        <div class="stat-label">Queued</div>
      </div>
    </div>

    <div class="sidebar-spacer"></div>

    <div class="sidebar-footer">
      <div class="live-dot pulse" id="live-indicator"></div>
      <span id="live-text">Worker active</span>
    </div>
  </aside>

  <!-- MAIN AREA -->
  <main id="main">
    <div id="intake" class="intake-zone">
      <div class="intake-label">Add a download</div>
      <div class="intake-form" id="intake-form-wrap">
        <div class="intake-shell" id="intake-shell">
          <span class="intake-icon">‚Üì</span>
          <input type="url" id="intake-input"
            placeholder="Paste a post URL from X or TikTok‚Ä¶"
            autocomplete="off" spellcheck="false">
          <div class="platform-chip x-chip" id="platform-chip-x">ùïè X</div>
          <div class="platform-chip tiktok-chip" id="platform-chip-tt">‚ô™ TikTok</div>
        </div>
        <button class="intake-btn" id="intake-submit" onclick="submitJob()">Download</button>
      </div>
    </div>

    <div id="content" class="main-area">
      <div class="content-header">
        <div class="content-title">Creators</div>
        <div style="display:flex; gap:8px; align-items:center;">
          <div class="job-count-badge" id="total-badge">7 jobs</div>
          <div class="view-toggle">
            <button class="view-btn active" onclick="setView('folders')">Folders</button>
            <button class="view-btn" onclick="setView('all')">All Jobs</button>
          </div>
        </div>
      </div>

      <div id="folders-view">
        <!-- Dynamically generated -->
      </div>

      <div id="all-view" style="display:none;">
        <div id="all-jobs-list" class="job-list-inner" style="padding:0; gap:6px;">
          <!-- Dynamically generated -->
        </div>
      </div>
    </div>
  </main>

  <!-- ACTIVITY PANEL -->
  <aside id="activity" class="side-panel">
    <div class="activity-header">
      <div class="activity-title">Activity</div>
      <div class="activity-live-badge">
        <div class="live-dot pulse"></div>
        Live
      </div>
    </div>
    <div id="activity-feed"></div>
    <button class="scroll-bottom-btn" id="scroll-btn" onclick="scrollFeedBottom()" title="Jump to latest">‚Üì</button>
  </aside>
</div>

<script>
  // ============================================================
  // DATA MODEL
  // ============================================================
  const contacts = [
    { slug: 'kaito_yamamoto', display: '@kaito_yamamoto', platform: 'x', emoji: 'üéÆ' },
    { slug: 'aria_voss', display: '@aria_voss', platform: 'tiktok', emoji: 'üéµ' },
    { slug: 'devlin_marsh', display: '@devlin_marsh', platform: 'x', emoji: '‚ö°' },
    { slug: 'priya_chen', display: '@priya_chen', platform: 'tiktok', emoji: 'üå∏' },
  ];

  let jobs = [
    { id:'j1', creator:'kaito_yamamoto', platform:'x', title:'Thread on procedural generation tech', status:'completed', size:'142 MB', duration:'4:22', ts:'2 min ago' },
    { id:'j2', creator:'kaito_yamamoto', platform:'x', title:'Live coding session highlights', status:'completed', size:'89 MB', duration:'2:10', ts:'18 min ago' },
    { id:'j3', creator:'aria_voss', platform:'tiktok', title:'Morning routine ‚Äî ambient edit', status:'running', size:'‚Äî', duration:'1:30', ts:'just now', progress:34 },
    { id:'j4', creator:'aria_voss', platform:'tiktok', title:'Recipe: soft-scrambled eggs', status:'queued', size:'‚Äî', duration:'0:58', ts:'1 min ago', progress:0 },
    { id:'j5', creator:'devlin_marsh', platform:'x', title:'Kernel debugging walkthrough', status:'failed', size:'‚Äî', duration:'8:45', ts:'5 min ago', error:'Extraction timeout' },
    { id:'j6', creator:'devlin_marsh', platform:'x', title:'SSH tunneling explainer', status:'completed', size:'320 MB', duration:'12:03', ts:'1 hr ago' },
    { id:'j7', creator:'priya_chen', platform:'tiktok', title:'Botanical watercolor timelapse', status:'running', size:'‚Äî', duration:'3:15', ts:'just now', progress:61 },
  ];

  let currentView = 'folders';
  let openFolders = new Set(['aria_voss']); // one open by default
  let runningPulseAssigned = false;
  let platformState = { x: true, tiktok: true };

  // ============================================================
  // RENDER
  // ============================================================
  function getStatusSymbol(status) {
    return { completed: '‚úì', running: '‚ñ∂', failed: '‚úï', queued: '‚óã', canceled: '‚óá' }[status] || '?';
  }

  function renderJobCard(job, index, isFirstRunning) {
    const isRunning = job.status === 'running';
    const pulseClass = (isRunning && isFirstRunning) ? ' running-pulse' : '';

    let rightEl = '';
    if (isRunning) {
      const circ = 2 * Math.PI * 11; // r=11
      const offset = circ - (job.progress / 100) * circ;
      rightEl = `
        <div class="progress-ring-wrap">
          <svg class="progress-ring" width="28" height="28" viewBox="0 0 28 28">
            <circle class="progress-ring-bg" cx="14" cy="14" r="11" fill="none" stroke-width="2.5"/>
            <circle class="progress-ring-fill" id="ring-${job.id}" cx="14" cy="14" r="11" fill="none"
              stroke-width="2.5"
              stroke-dasharray="${circ.toFixed(1)}"
              stroke-dashoffset="${offset.toFixed(1)}"/>
          </svg>
          <div class="progress-pct-label numeric" id="pct-${job.id}">${job.progress}%</div>
        </div>`;
    } else {
      rightEl = `<div class="job-actions">
        ${job.status === 'failed' ? `<button class="job-action-btn" title="Retry" onclick="retryJob('${job.id}')">‚Ü∫</button>` : ''}
        <button class="job-action-btn" title="Delete" onclick="deleteJob('${job.id}')">√ó</button>
      </div>`;
    }

    const delay = Math.max(0, 120 - index * 20);
    return `
      <div class="job-card" id="card-${job.id}" style="animation-delay:${delay}ms">
        <div class="job-status-glyph status-${job.status}${pulseClass}">${getStatusSymbol(job.status)}</div>
        <div class="job-info">
          <div class="job-title">${job.title}</div>
          <div class="job-meta-row">
            <span class="job-platform-tag ${job.platform}">${job.platform === 'x' ? 'ùïè' : '‚ô™'} ${job.platform}</span>
            ${job.size !== '‚Äî' ? `<span class="numeric">${job.size}</span>` : ''}
            ${job.duration ? `<span class="numeric">${job.duration}</span>` : ''}
            <span class="timestamp">${job.ts}</span>
            ${job.error ? `<span style="color:var(--status-failed);font-size:var(--t-caption)">‚ö† ${job.error}</span>` : ''}
          </div>
        </div>
        ${rightEl}
      </div>`;
  }

  function renderFolders() {
    runningPulseAssigned = false;
    const foldersEl = document.getElementById('folders-view');
    const byCreator = {};

    contacts.forEach(c => { byCreator[c.slug] = { contact: c, jobs: [] }; });
    jobs.forEach(j => {
      if (byCreator[j.creator]) byCreator[j.creator].jobs.push(j);
    });

    let html = '';
    contacts.forEach(c => {
      const group = byCreator[c.slug];
      if (!group) return;
      const isOpen = openFolders.has(c.slug);
      const runningCount = group.jobs.filter(j => j.status === 'running').length;
      const completedCount = group.jobs.filter(j => j.status === 'completed').length;

      let jobsHtml = '';
      group.jobs.forEach((job, i) => {
        const isFirstRunning = job.status === 'running' && !runningPulseAssigned;
        if (isFirstRunning) runningPulseAssigned = true;
        jobsHtml += renderJobCard(job, i, isFirstRunning);
      });

      html += `
        <div class="folder ${isOpen ? 'open' : ''}" id="folder-${c.slug}">
          <div class="folder-tab" onclick="toggleFolder('${c.slug}')">
            <div class="folder-icon">${c.emoji}</div>
            <div class="folder-meta">
              <div class="folder-name">${c.display}</div>
              <div class="folder-subtitle">
                ${completedCount} completed${runningCount ? ` ¬∑ <span style="color:var(--status-running)">${runningCount} running</span>` : ''}
              </div>
            </div>
            <div class="folder-stats">
              <span class="folder-count numeric">${group.jobs.length} jobs</span>
              <span class="folder-chevron">‚ñ∂</span>
            </div>
          </div>
          <div class="folder-contents">
            <div class="folder-divider"></div>
            <div class="job-list-inner">${jobsHtml}</div>
          </div>
        </div>`;
    });

    foldersEl.innerHTML = html;
  }

  function renderAllJobs() {
    runningPulseAssigned = false;
    const listEl = document.getElementById('all-jobs-list');
    let html = '';
    jobs.forEach((job, i) => {
      const isFirstRunning = job.status === 'running' && !runningPulseAssigned;
      if (isFirstRunning) runningPulseAssigned = true;
      html += renderJobCard(job, i, isFirstRunning);
    });
    listEl.innerHTML = html;
  }

  function render() {
    if (currentView === 'folders') {
      renderFolders();
    } else {
      renderAllJobs();
    }
    updateStats();
    document.getElementById('total-badge').textContent = jobs.length + ' job' + (jobs.length !== 1 ? 's' : '');
  }

  function updateStats() {
    document.getElementById('stat-complete').textContent = jobs.filter(j => j.status === 'completed').length;
    document.getElementById('stat-failed').textContent = jobs.filter(j => j.status === 'failed').length;
    document.getElementById('stat-running').textContent = jobs.filter(j => j.status === 'running').length;
    document.getElementById('stat-queued').textContent = jobs.filter(j => j.status === 'queued').length;
    document.getElementById('hero-num').textContent = jobs.filter(j => j.status === 'completed').length + 18;
    // Live indicator based on running
    const hasRunning = jobs.some(j => j.status === 'running');
    const dot = document.getElementById('live-indicator');
    dot.classList.toggle('pulse', hasRunning);
    document.getElementById('live-text').textContent = hasRunning ? 'Worker active' : 'Worker idle';
  }

  // ============================================================
  // FOLDER TOGGLE
  // ============================================================
  function toggleFolder(slug) {
    if (openFolders.has(slug)) {
      openFolders.delete(slug);
    } else {
      openFolders.add(slug);
    }
    render();
  }

  function setView(v) {
    currentView = v;
    document.getElementById('folders-view').style.display = v === 'folders' ? '' : 'none';
    document.getElementById('all-view').style.display = v === 'all' ? '' : 'none';
    document.querySelectorAll('.view-btn').forEach(b => b.classList.toggle('active', b.textContent.toLowerCase().startsWith(v)));
    render();
  }

  // ============================================================
  // INTAKE FORM ‚Äî PLATFORM DETECTION + MAGNETIC HOVER
  // ============================================================
  const intakeInput = document.getElementById('intake-input');
  const chipX = document.getElementById('platform-chip-x');
  const chipTt = document.getElementById('platform-chip-tt');
  const intakeShell = document.getElementById('intake-shell');

  intakeInput.addEventListener('input', () => {
    const val = intakeInput.value;
    const isX = /twitter\.com|x\.com/i.test(val);
    const isTt = /tiktok\.com/i.test(val);
    chipX.classList.toggle('visible', isX);
    chipTt.classList.toggle('visible', isTt);
  });

  // Magnetic hover
  const intakeWrap = document.getElementById('intake-form-wrap');
  intakeWrap.addEventListener('mousemove', e => {
    const rect = intakeWrap.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;
    const dx = (e.clientX - cx) / rect.width * 4;
    const dy = (e.clientY - cy) / rect.height * 3;
    intakeShell.style.transform = `translate(${dx.toFixed(2)}px, ${dy.toFixed(2)}px)`;
  });

  intakeWrap.addEventListener('mouseleave', () => {
    intakeShell.style.transform = '';
  });

  // ============================================================
  // SUBMIT JOB
  // ============================================================
  function submitJob() {
    const val = intakeInput.value.trim();
    if (!val) {
      intakeShell.style.outline = '2px solid var(--status-failed)';
      setTimeout(() => { intakeShell.style.outline = ''; }, 1200);
      return;
    }

    const isX = /twitter\.com|x\.com/i.test(val);
    const isTt = /tiktok\.com/i.test(val);
    const platform = isTt ? 'tiktok' : 'x';

    // Success flash
    const btn = document.getElementById('intake-submit');
    btn.textContent = '‚úì Queued';
    btn.classList.add('success');

    // Add job
    const newJob = {
      id: 'j' + Date.now(),
      creator: isX ? 'kaito_yamamoto' : 'aria_voss',
      platform,
      title: val.substring(0, 60),
      status: 'queued',
      size: '‚Äî',
      duration: '‚Äî',
      ts: 'just now',
      progress: 0
    };
    jobs.unshift(newJob);

    // Auto-open the folder for the new job
    openFolders.add(newJob.creator);

    addActivity('info', `Job queued: ${newJob.title.substring(0,40)}‚Ä¶`);
    showNotif('‚úì', 'Added to queue');
    render();

    setTimeout(() => {
      btn.textContent = 'Download';
      btn.classList.remove('success');
      intakeInput.value = '';
      chipX.classList.remove('visible');
      chipTt.classList.remove('visible');
    }, 900);
  }

  // ============================================================
  // TOGGLE PLATFORM
  // ============================================================
  function togglePlatform(p) {
    platformState[p] = !platformState[p];
    const btn = document.getElementById('toggle-' + p);
    btn.classList.toggle('on', platformState[p]);
    addActivity(platformState[p] ? 'ok' : 'warn', `${p.toUpperCase()} platform ${platformState[p] ? 'enabled' : 'disabled'}`);
  }

  // ============================================================
  // JOB ACTIONS
  // ============================================================
  function deleteJob(id) {
    jobs = jobs.filter(j => j.id !== id);
    addActivity('warn', 'Job deleted');
    render();
  }

  function retryJob(id) {
    const j = jobs.find(j => j.id === id);
    if (j) {
      j.status = 'queued';
      j.error = null;
      j.ts = 'just now';
      addActivity('info', `Retrying: ${j.title.substring(0,40)}`);
      render();
    }
  }

  // ============================================================
  // NOTIFICATION BAR
  // ============================================================
  let notifTimer;
  function showNotif(icon, text) {
    const bar = document.getElementById('notif-bar');
    document.getElementById('notif-icon').textContent = icon;
    document.getElementById('notif-text').textContent = text;
    bar.classList.add('show');
    clearTimeout(notifTimer);
    notifTimer = setTimeout(() => bar.classList.remove('show'), 2500);
  }

  // ============================================================
  // ACTIVITY FEED
  // ============================================================
  const activityMessages = [
    ['info', 'Playwright: navigating to post URL'],
    ['info', 'Network interception active'],
    ['info', 'Media stream detected ‚Äî HLS manifest'],
    ['ok', 'Extraction complete ‚Äî 3 candidates found'],
    ['info', 'Selecting best quality stream: 1080p H.264'],
    ['info', 'ffmpeg: starting HLS download'],
    ['info', 'Download progress: 45%'],
    ['info', 'Download progress: 78%'],
    ['ok', 'Job completed ‚Äî 142 MB saved'],
    ['info', 'Worker claiming next job from queue'],
    ['warn', 'Rate limit detected on X.com ‚Äî backing off 3s'],
    ['info', 'Playwright: navigating to TikTok post'],
    ['ok', 'TikTok media extracted ‚Äî direct MP4 link'],
    ['info', 'Direct fetch started ‚Äî bypassing ffmpeg'],
    ['error', 'Extraction timeout after 30s ‚Äî job failed'],
    ['info', 'Queue worker polling ‚Äî 0 jobs pending'],
    ['ok', 'Job j3 completed ‚Äî 89 MB saved'],
    ['warn', 'Cloudflare challenge detected ‚Äî waiting for solve'],
  ];

  let activityIdx = 0;
  function addActivity(level, text) {
    const feed = document.getElementById('activity-feed');
    const now = new Date();
    const ts = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });

    const levelMap = { info: 'I', warn: 'W', error: 'E', ok: '‚úì' };
    const el = document.createElement('div');
    el.className = 'activity-entry';
    el.innerHTML = `
      <div class="entry-level ${level}">${levelMap[level] || 'I'}</div>
      <div class="entry-content">
        <div class="entry-text">${text}</div>
        <div class="entry-time timestamp">${ts}</div>
      </div>`;

    feed.insertBefore(el, feed.firstChild);

    // Keep max 60 entries
    while (feed.children.length > 60) feed.removeChild(feed.lastChild);
  }

  // Auto-push activity
  setInterval(() => {
    const [level, text] = activityMessages[activityIdx % activityMessages.length];
    addActivity(level, text);
    activityIdx++;
  }, 2800);

  // Scroll button for activity
  const actFeed = document.getElementById('activity-feed');
  const scrollBtn = document.getElementById('scroll-btn');
  actFeed.addEventListener('scroll', () => {
    scrollBtn.classList.toggle('visible', actFeed.scrollTop > 100);
  });

  function scrollFeedBottom() {
    actFeed.scrollTo({ top: 0, behavior: 'smooth' });
  }

  // ============================================================
  // SIMULATION ‚Äî advance jobs over time
  // ============================================================
  function advanceJobs() {
    let changed = false;
    jobs.forEach(job => {
      if (job.status === 'running') {
        job.progress = Math.min(100, job.progress + Math.random() * 8 + 3);
        if (job.progress >= 100) {
          job.status = 'completed';
          job.size = (Math.random() * 280 + 40).toFixed(0) + ' MB';
          job.ts = 'just now';
          addActivity('ok', `Job completed: ${job.title.substring(0,35)}‚Ä¶`);
          showNotif('‚úì', 'Download complete');
          changed = true;
        } else {
          // Update ring without full re-render
          const ring = document.getElementById('ring-' + job.id);
          const pct = document.getElementById('pct-' + job.id);
          if (ring) {
            const r = 11, circ = 2 * Math.PI * r;
            ring.style.strokeDashoffset = (circ - (job.progress / 100) * circ).toFixed(1);
          }
          if (pct) pct.textContent = Math.round(job.progress) + '%';
        }
      } else if (job.status === 'queued') {
        // Eventually start running
        if (Math.random() < 0.08) {
          job.status = 'running';
          job.progress = 0;
          job.ts = 'just now';
          addActivity('info', `Job started: ${job.title.substring(0,35)}‚Ä¶`);
          changed = true;
        }
      }
    });
    if (changed) render();
  }

  setInterval(advanceJobs, 1200);

  // ============================================================
  // INIT
  // ============================================================
  window.addEventListener('load', () => {
    render();

    // Seed activity
    [
      ['info', 'Media Vault initialized'],
      ['info', 'MongoDB connected'],
      ['info', 'Playwright browser context ready'],
      ['ok', 'Queue worker started ‚Äî 1s poll interval'],
    ].forEach(([l, t], i) => {
      setTimeout(() => addActivity(l, t), i * 200);
    });

    // Show app
    setTimeout(() => {
      document.getElementById('app').classList.add('ready');
    }, 50);
  });
</script>
</body>
</html>
