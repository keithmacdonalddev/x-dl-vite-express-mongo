<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Media Vault ‚Äî Kanban Board</title>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --bg: #f1f3f9;
  --card: #fff;
  --text: #0d1321;
  --muted: #5c6a82;
  --border: #dde3ef;
  --accent: #3b5bdb;
  --accent2: #2f4ac5;
  --shadow-sm: 0 1px 4px rgba(0,0,0,.07);
  --shadow-md: 0 4px 16px rgba(0,0,0,.10);
  --shadow-lg: 0 8px 32px rgba(0,0,0,.15);
  --q-bg: #f0f4ff; --q-bd: #c7d4ff; --q-clr: #3b5bdb;
  --r-bg: #fff8e6; --r-bd: #ffd980; --r-clr: #e67700;
  --c-bg: #edfff4; --c-bd: #8de5b0; --c-clr: #2f9e44;
  --f-bg: #fff0f0; --f-bd: #ffb3b3; --f-clr: #c92a2a;
}
body { font-family:'Segoe UI',system-ui,sans-serif; background:var(--bg); color:var(--text); min-height:100vh; overflow-x:hidden; }

/* TOP BAR */
.topbar { display:flex; align-items:center; gap:12px; padding:0 20px; height:52px; background:#fff; border-bottom:1px solid var(--border); position:sticky; top:0; z-index:100; box-shadow:var(--shadow-sm); }
.logo { display:flex; align-items:center; gap:8px; font-weight:800; font-size:17px; color:var(--accent); text-decoration:none; letter-spacing:-.5px; }
.logo-icon { width:30px; height:30px; border-radius:8px; background:var(--accent); display:flex; align-items:center; justify-content:center; color:#fff; font-size:14px; font-weight:900; }
.divider { width:1px; height:22px; background:var(--border); }
.topbar-right { display:flex; align-items:center; gap:10px; margin-left:auto; }
.btn { display:inline-flex; align-items:center; gap:5px; padding:6px 13px; border-radius:8px; font-size:12px; font-weight:700; cursor:pointer; border:none; transition:all .15s; white-space:nowrap; }
.btn:hover { transform:translateY(-1px); }
.btn:active { transform:translateY(0) scale(.97); }
.btn-ghost { background:transparent; color:var(--muted); border:1px solid var(--border); }
.btn-ghost:hover { background:var(--bg); color:var(--text); border-color:#aab8d8; }
.btn-accent { background:var(--accent); color:#fff; box-shadow:0 2px 8px rgba(59,91,219,.3); }
.btn-accent:hover { background:var(--accent2); box-shadow:0 4px 14px rgba(59,91,219,.45); }
.toggle-wrap { display:flex; align-items:center; gap:5px; }
.tgl-lbl { font-size:11px; font-weight:700; color:var(--muted); }
.tgl { position:relative; display:inline-block; width:34px; height:18px; }
.tgl input { opacity:0; width:0; height:0; }
.tgl-track { position:absolute; cursor:pointer; inset:0; background:#cbd5e0; border-radius:9px; transition:.2s; }
.tgl-track::before { position:absolute; content:""; height:12px; width:12px; left:3px; bottom:3px; background:#fff; border-radius:50%; transition:.2s; box-shadow:0 1px 2px rgba(0,0,0,.2); }
input:checked+.tgl-track { background:var(--accent); }
input:checked+.tgl-track::before { transform:translateX(16px); }

/* FILTER BAR */
.filter-bar { display:flex; align-items:center; gap:8px; padding:10px 20px; background:#fff; border-bottom:1px solid var(--border); overflow-x:auto; }
.filter-lbl { font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:.08em; color:var(--muted); white-space:nowrap; }
.chip { display:inline-flex; align-items:center; gap:5px; padding:4px 10px 4px 5px; border-radius:999px; font-size:12px; font-weight:600; cursor:pointer; border:1.5px solid var(--border); background:#f5f5f8; color:var(--text); transition:all .15s; white-space:nowrap; user-select:none; }
.chip:hover { border-color:var(--accent); }
.chip.active { background:#e8ecfc; color:var(--accent); border-color:var(--accent); }
.chip-av { width:18px; height:18px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:8px; font-weight:700; color:#fff; flex-shrink:0; }
.chip-all { background:#e8ecfc; color:var(--accent); border-color:var(--q-bd); }
.chip-all.active,.chip-all:hover { background:var(--accent); color:#fff; border-color:var(--accent); }
.view-tgl { display:flex; align-items:center; gap:3px; margin-left:auto; background:var(--bg); border:1px solid var(--border); border-radius:7px; padding:2px; flex-shrink:0; }
.vbtn { padding:4px 10px; border-radius:5px; font-size:11px; font-weight:700; border:none; cursor:pointer; background:transparent; color:var(--muted); transition:all .15s; }
.vbtn.active { background:#fff; color:var(--text); box-shadow:var(--shadow-sm); }

/* BOARD */
.board-wrap { padding:18px 20px 60px; overflow-x:auto; }
.board { display:grid; grid-template-columns:repeat(4,minmax(270px,1fr)); gap:14px; min-width:1080px; }
.board.swimlane { display:flex; flex-direction:column; gap:16px; min-width:unset; }

/* COLUMN */
.col { display:flex; flex-direction:column; border-radius:12px; border:1.5px solid transparent; min-height:480px; transition:box-shadow .2s,border-color .2s; }
.col.queued  { background:var(--q-bg); border-color:var(--q-bd); }
.col.running { background:var(--r-bg); border-color:var(--r-bd); }
.col.completed { background:var(--c-bg); border-color:var(--c-bd); }
.col.failed  { background:var(--f-bg); border-color:var(--f-bd); }
.col.drag-over { box-shadow:0 0 0 3px var(--accent) !important; }
.col-hd { display:flex; align-items:center; gap:7px; padding:13px 14px 10px; }
.col-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
.col.queued .col-dot { background:var(--q-clr); }
.col.running .col-dot { background:var(--r-clr); animation:pdot 1.5s ease-in-out infinite; }
.col.completed .col-dot { background:var(--c-clr); }
.col.failed .col-dot { background:var(--f-clr); }
@keyframes pdot { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(1.5)} }
.col-title { font-size:11px; font-weight:800; text-transform:uppercase; letter-spacing:.1em; }
.col.queued .col-title { color:var(--q-clr); }
.col.running .col-title { color:var(--r-clr); }
.col.completed .col-title { color:var(--c-clr); }
.col.failed .col-title { color:var(--f-clr); }
.col-cnt { margin-left:auto; background:rgba(0,0,0,.08); border-radius:999px; padding:2px 7px; font-size:11px; font-weight:700; }
.col-body { flex:1; padding:0 10px 10px; display:flex; flex-direction:column; gap:7px; }

/* ADD CARD */
.add-area { margin:0 10px 7px; position:relative; }
.add-inp { width:100%; padding:9px 36px 9px 11px; border:1.5px solid var(--q-bd); border-radius:8px; font-size:12px; background:#fff; color:var(--text); transition:all .2s; outline:none; }
.add-inp:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(59,91,219,.15); }
.add-inp::placeholder { color:#aab; font-size:11px; }
.add-sub { position:absolute; right:5px; top:50%; transform:translateY(-50%); width:26px; height:26px; border-radius:6px; background:var(--accent); color:#fff; border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:17px; line-height:1; transition:all .15s; }
.add-sub:hover { background:var(--accent2); transform:translateY(-50%) scale(1.1); }
.add-sub:active { transform:translateY(-50%) scale(.95); }

/* JOB CARD */
.jcard { background:#fff; border-radius:9px; padding:11px; box-shadow:var(--shadow-sm); border:1.5px solid rgba(0,0,0,.04); cursor:grab; transition:all .2s; position:relative; user-select:none; }
.jcard:hover { transform:translateY(-2px); box-shadow:var(--shadow-md); }
.jcard.selected { border-color:var(--accent); box-shadow:0 0 0 2px rgba(59,91,219,.2); }
.jcard.dragging { opacity:.45; cursor:grabbing; transform:scale(.97); }
.jcard-top { display:flex; align-items:flex-start; gap:7px; margin-bottom:7px; }
.jthumbl { width:44px; height:44px; border-radius:7px; background:#e0e4ef; display:flex; align-items:center; justify-content:center; font-size:19px; flex-shrink:0; }
.jinfo { flex:1; min-width:0; }
.jcreator { font-size:10px; font-weight:800; color:var(--accent); text-transform:uppercase; letter-spacing:.05em; margin-bottom:1px; }
.jtitle { font-size:12px; font-weight:700; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.jurl { font-size:10px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.jchk { width:15px; height:15px; border-radius:4px; border:1.5px solid var(--border); cursor:pointer; display:flex; align-items:center; justify-content:center; flex-shrink:0; transition:all .15s; background:#fff; margin-top:1px; }
.jcard.selected .jchk { background:var(--accent); border-color:var(--accent); color:#fff; }
.jchk::after { content:'‚úì'; font-size:9px; font-weight:800; opacity:0; transition:opacity .15s; }
.jcard.selected .jchk::after { opacity:1; }
.jmeta { display:flex; align-items:center; gap:5px; flex-wrap:wrap; }
.pbadge { display:inline-flex; align-items:center; gap:2px; padding:2px 5px; border-radius:4px; font-size:9px; font-weight:700; background:#f0f0f0; color:var(--muted); }
.pbadge.x { background:#e8e8f0; color:#333; }
.pbadge.tiktok { background:#ffe8f5; color:#c91a7c; }
.jtime { font-size:9px; color:var(--muted); }
.prog-wrap { margin-top:7px; height:3px; background:rgba(230,119,0,.2); border-radius:999px; overflow:hidden; }
.prog-fill { height:100%; border-radius:999px; background:linear-gradient(90deg,#e67700,#ffd43b,#e67700); background-size:200% 100%; animation:shimmer 2s linear infinite; }
@keyframes shimmer { 0%{background-position:200% center} 100%{background-position:-200% center} }
.jacts { display:flex; gap:3px; margin-top:7px; opacity:0; transition:opacity .2s; }
.jcard:hover .jacts { opacity:1; }
.jact { padding:2px 7px; border-radius:4px; font-size:9px; font-weight:700; cursor:pointer; border:1px solid var(--border); background:#fff; color:var(--muted); transition:all .15s; }
.jact:hover { background:var(--bg); color:var(--text); border-color:#aab8d8; }
.jact.danger:hover { background:#fff0f0; color:var(--f-clr); border-color:var(--f-bd); }

/* SWIMLANE */
.swim-row { background:#fff; border:1px solid var(--border); border-radius:12px; overflow:hidden; box-shadow:var(--shadow-sm); }
.swim-hd { display:flex; align-items:center; gap:10px; padding:11px 15px; background:#f8f9fc; border-bottom:1px solid var(--border); }
.swim-av { width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px; font-weight:700; color:#fff; flex-shrink:0; }
.swim-name { font-weight:700; font-size:13px; }
.swim-sub { font-size:11px; color:var(--muted); }
.swim-cnt { margin-left:auto; font-size:11px; color:var(--muted); background:var(--bg); padding:2px 8px; border-radius:999px; }
.swim-cols-hd { display:grid; grid-template-columns:repeat(4,1fr); }
.swim-col-lbl { padding:7px 10px; font-size:10px; font-weight:800; text-transform:uppercase; letter-spacing:.08em; color:var(--muted); border-bottom:1px solid var(--border); border-right:1px solid var(--border); }
.swim-col-lbl:last-child { border-right:none; }
.swim-cols { display:grid; grid-template-columns:repeat(4,1fr); }
.swim-col { padding:8px 10px; border-right:1px solid var(--border); min-height:60px; }
.swim-col:last-child { border-right:none; }
.swim-mini { padding:5px 7px; border-radius:6px; border:1px solid var(--border); background:#fff; margin-bottom:5px; font-size:10px; cursor:pointer; transition:background .15s; }
.swim-mini:hover { background:var(--bg); }
.swim-empty { color:var(--muted); font-size:10px; text-align:center; padding-top:10px; }

/* BULK BAR */
.bulk-bar { position:fixed; bottom:-80px; left:50%; transform:translateX(-50%); background:#1a1f36; color:#fff; border-radius:13px; padding:11px 18px; display:flex; align-items:center; gap:10px; box-shadow:var(--shadow-lg); z-index:200; transition:bottom .3s cubic-bezier(.34,1.56,.64,1); white-space:nowrap; }
.bulk-bar.on { bottom:20px; }
.bcnt { font-size:12px; font-weight:700; background:rgba(255,255,255,.15); padding:3px 9px; border-radius:999px; }
.bbtn { padding:5px 11px; border-radius:7px; font-size:11px; font-weight:700; cursor:pointer; border:none; transition:all .15s; }
.bbtn-cancel { background:rgba(255,255,255,.1); color:rgba(255,255,255,.7); }
.bbtn-cancel:hover { background:rgba(255,255,255,.2); }
.bbtn-del { background:#c92a2a; color:#fff; }
.bbtn-del:hover { background:#a61e1e; }
.bbtn-retry { background:var(--accent); color:#fff; }
.bbtn-retry:hover { background:var(--accent2); }

/* DRAWER TOGGLE */
.dtgl { position:fixed; bottom:20px; right:20px; z-index:150; width:46px; height:46px; border-radius:50%; background:#1a1f36; color:#fff; border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:18px; box-shadow:var(--shadow-lg); transition:all .2s; }
.dtgl:hover { transform:scale(1.1); background:var(--accent); }
.dbadge { position:absolute; top:-3px; right:-3px; width:17px; height:17px; border-radius:50%; background:#c92a2a; color:#fff; font-size:9px; font-weight:700; display:flex; align-items:center; justify-content:center; border:2px solid #fff; }

/* ACTIVITY DRAWER */
.drawer { position:fixed; bottom:-100%; left:0; right:0; height:340px; background:#fff; border-top:1px solid var(--border); border-radius:18px 18px 0 0; z-index:140; box-shadow:0 -6px 32px rgba(0,0,0,.14); transition:bottom .4s cubic-bezier(.34,1.2,.64,1); display:flex; flex-direction:column; }
.drawer.open { bottom:0; }
.drw-handle { width:36px; height:4px; border-radius:2px; background:var(--border); margin:10px auto 0; cursor:pointer; flex-shrink:0; }
.drw-hd { display:flex; align-items:center; gap:8px; padding:10px 18px; border-bottom:1px solid var(--border); flex-shrink:0; }
.drw-title { font-size:13px; font-weight:700; }
.live-dot { width:7px; height:7px; border-radius:50%; background:#2f9e44; animation:pdot 1.5s ease-in-out infinite; }
.drw-close { margin-left:auto; background:none; border:none; font-size:16px; cursor:pointer; color:var(--muted); padding:2px 5px; border-radius:4px; }
.drw-close:hover { background:var(--bg); color:var(--text); }
.drw-body { flex:1; overflow-y:auto; padding:10px 18px; display:flex; flex-direction:column; gap:5px; }
.aitem { display:flex; align-items:flex-start; gap:8px; padding:7px 8px; border-radius:7px; animation:fsin .3s ease; }
@keyframes fsin { from{opacity:0;transform:translateY(-5px)} to{opacity:1;transform:translateY(0)} }
.aitem:hover { background:var(--bg); }
.aico { width:26px; height:26px; border-radius:6px; display:flex; align-items:center; justify-content:center; font-size:12px; flex-shrink:0; }
.aico.info { background:#e8ecfc; }
.aico.success { background:#edfff4; }
.aico.error { background:#fff0f0; }
.aico.warn { background:#fff8e6; }
.atxt { font-size:11px; color:var(--text); line-height:1.4; }
.atme { font-size:9px; color:var(--muted); margin-top:1px; }

/* MODAL */
.overlay { position:fixed; inset:0; background:rgba(0,0,0,.4); backdrop-filter:blur(4px); z-index:300; display:none; align-items:center; justify-content:center; padding:20px; }
.overlay.open { display:flex; }
.modal { background:#fff; border-radius:18px; width:100%; max-width:660px; max-height:80vh; overflow:hidden; display:flex; flex-direction:column; box-shadow:var(--shadow-lg); animation:mdin .3s cubic-bezier(.34,1.4,.64,1); }
@keyframes mdin { from{opacity:0;transform:scale(.92) translateY(18px)} to{opacity:1;transform:scale(1) translateY(0)} }
.m-hd { display:flex; align-items:center; gap:12px; padding:18px 22px; border-bottom:1px solid var(--border); }
.m-av { width:48px; height:48px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:18px; font-weight:700; color:#fff; }
.m-name { font-size:17px; font-weight:700; }
.m-sub { font-size:12px; color:var(--muted); }
.m-stats { display:flex; gap:18px; margin-left:auto; }
.mstat-v { font-size:19px; font-weight:800; color:var(--accent); text-align:center; }
.mstat-l { font-size:9px; color:var(--muted); text-transform:uppercase; letter-spacing:.08em; text-align:center; }
.m-close { margin-left:10px; background:var(--bg); border:none; width:30px; height:30px; border-radius:7px; cursor:pointer; font-size:15px; display:flex; align-items:center; justify-content:center; color:var(--muted); transition:all .15s; }
.m-close:hover { background:var(--border); color:var(--text); }
.m-body { flex:1; overflow-y:auto; padding:14px 22px; }
.mjrow { display:flex; align-items:center; gap:10px; padding:9px 10px; border-radius:9px; border:1px solid var(--border); margin-bottom:6px; transition:all .15s; }
.mjrow:hover { background:var(--bg); border-color:#aab8d8; }
.mjth { width:38px; height:38px; border-radius:6px; background:#e0e4ef; display:flex; align-items:center; justify-content:center; font-size:17px; flex-shrink:0; }
.mjinf { flex:1; min-width:0; }
.mjtitle { font-size:12px; font-weight:700; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.mjdate { font-size:10px; color:var(--muted); }
.spill { padding:2px 7px; border-radius:999px; font-size:9px; font-weight:800; text-transform:uppercase; letter-spacing:.05em; }
.spill.queued { background:var(--q-bg); color:var(--q-clr); }
.spill.running { background:var(--r-bg); color:var(--r-clr); }
.spill.completed { background:var(--c-bg); color:var(--c-clr); }
.spill.failed { background:var(--f-bg); color:var(--f-clr); }

/* TOAST */
.toast-box { position:fixed; top:62px; right:18px; z-index:500; display:flex; flex-direction:column; gap:6px; pointer-events:none; }
.toast { padding:9px 15px; border-radius:9px; font-size:12px; font-weight:700; box-shadow:var(--shadow-md); pointer-events:auto; animation:tsin .3s cubic-bezier(.34,1.4,.64,1); display:flex; align-items:center; gap:7px; background:#fff; }
@keyframes tsin { from{opacity:0;transform:translateX(36px)} to{opacity:1;transform:translateX(0)} }
.toast.success { border-left:3px solid #2f9e44; }
.toast.error { border-left:3px solid #c92a2a; }
.toast.info { border-left:3px solid var(--accent); }

/* RESPONSIVE */
@media(max-width:980px) {
  .board { grid-template-columns:repeat(2,1fr); min-width:unset; }
  .topbar { padding:0 12px; gap:8px; }
  .filter-bar { padding:8px 12px; }
  .board-wrap { padding:12px 12px 80px; }
  .modal { max-width:100%; max-height:90vh; }
  .dtgl { bottom:76px; right:12px; }
  .swim-cols,.swim-cols-hd { grid-template-columns:repeat(2,1fr); }
}
@media(prefers-reduced-motion:reduce) { *,*::before,*::after { animation:none !important; transition:none !important; } }
</style>
</head>
<body>

<header class="topbar">
  <div class="logo">
    <div class="logo-icon">MV</div>
    Media Vault
  </div>
  <div class="divider"></div>
  <span style="font-size:11px;color:var(--muted);font-weight:700;letter-spacing:.05em">KANBAN</span>
  <div class="topbar-right">
    <div class="toggle-wrap">
      <span class="tgl-lbl">ùïè</span>
      <label class="tgl"><input type="checkbox" checked onchange="showToast('X '+(this.checked?'enabled':'disabled'),this.checked?'success':'info')"><span class="tgl-track"></span></label>
    </div>
    <div class="toggle-wrap">
      <span class="tgl-lbl">TT</span>
      <label class="tgl"><input type="checkbox" checked onchange="showToast('TikTok '+(this.checked?'enabled':'disabled'),this.checked?'success':'info')"><span class="tgl-track"></span></label>
    </div>
    <div class="divider"></div>
    <button class="btn btn-ghost" onclick="openM('contacts')">üë§ Contacts</button>
    <button class="btn btn-accent" onclick="focusAdd()">+ Add Job</button>
  </div>
</header>

<div class="filter-bar">
  <span class="filter-lbl">Filter:</span>
  <div class="chip chip-all active" id="chip-all" onclick="filterBy('all',this)">All</div>
  <div class="chip" id="chip-techzilla" onclick="filterBy('techzilla',this);openM('p-techzilla')">
    <div class="chip-av" style="background:#3b5bdb">TZ</div>TechZilla
  </div>
  <div class="chip" id="chip-nightowl" onclick="filterBy('nightowl',this);openM('p-nightowl')">
    <div class="chip-av" style="background:#c91a7c">NO</div>NightOwl
  </div>
  <div class="chip" id="chip-codecraft" onclick="filterBy('codecraft',this)">
    <div class="chip-av" style="background:#2f9e44">CC</div>CodeCraft
  </div>
  <div class="chip" id="chip-voxpop" onclick="filterBy('voxpop',this)">
    <div class="chip-av" style="background:#e67700">VP</div>VoxPop
  </div>
  <div class="chip" id="chip-datadiver" onclick="filterBy('datadiver',this)">
    <div class="chip-av" style="background:#7048e8">DD</div>DataDiver
  </div>
  <div class="view-tgl">
    <button class="vbtn active" id="vk" onclick="setView('kanban')">Kanban</button>
    <button class="vbtn" id="vs" onclick="setView('swimlane')">Swimlanes</button>
  </div>
</div>

<div class="board-wrap">
  <div class="board" id="board">
    <div class="col queued" id="col-queued" ondragover="dov(event)" ondrop="dop(event,'queued')">
      <div class="col-hd"><div class="col-dot"></div><span class="col-title">Queued</span><span class="col-cnt" id="cnt-queued">0</span></div>
      <div class="add-area">
        <input class="add-inp" id="url-inp" type="text" placeholder="Paste X or TikTok URL‚Ä¶" onkeydown="if(event.key==='Enter')addJob()">
        <button class="add-sub" onclick="addJob()">+</button>
      </div>
      <div class="col-body" id="jobs-queued"></div>
    </div>
    <div class="col running" id="col-running" ondragover="dov(event)" ondrop="dop(event,'running')">
      <div class="col-hd"><div class="col-dot"></div><span class="col-title">Running</span><span class="col-cnt" id="cnt-running">0</span></div>
      <div class="col-body" id="jobs-running"></div>
    </div>
    <div class="col completed" id="col-completed" ondragover="dov(event)" ondrop="dop(event,'completed')">
      <div class="col-hd"><div class="col-dot"></div><span class="col-title">Completed</span><span class="col-cnt" id="cnt-completed">0</span></div>
      <div class="col-body" id="jobs-completed"></div>
    </div>
    <div class="col failed" id="col-failed" ondragover="dov(event)" ondrop="dop(event,'failed')">
      <div class="col-hd"><div class="col-dot"></div><span class="col-title">Failed</span><span class="col-cnt" id="cnt-failed">0</span></div>
      <div class="col-body" id="jobs-failed"></div>
    </div>
  </div>
</div>

<div class="bulk-bar" id="bulk-bar">
  <span class="bcnt" id="bcnt">0 selected</span>
  <div style="display:flex;gap:6px">
    <button class="bbtn bbtn-retry" onclick="bulkRetry()">‚Üª Retry</button>
    <button class="bbtn bbtn-del" onclick="bulkDel()">üóë Delete</button>
    <button class="bbtn bbtn-cancel" onclick="clearSel()">‚úï Cancel</button>
  </div>
</div>

<button class="dtgl" id="dtgl" onclick="toggleDrawer()">
  ‚ö°<div class="dbadge" id="dbadge">5</div>
</button>

<div class="drawer" id="drawer">
  <div class="drw-handle" onclick="toggleDrawer()"></div>
  <div class="drw-hd">
    <div class="live-dot"></div>
    <span class="drw-title">Live Activity</span>
    <span style="font-size:10px;color:var(--muted);margin-left:5px">Real-time telemetry</span>
    <button class="drw-close" onclick="toggleDrawer()">‚úï</button>
  </div>
  <div class="drw-body" id="activity-feed"></div>
</div>

<!-- CONTACTS MODAL -->
<div class="overlay" id="m-contacts"><div class="modal">
  <div class="m-hd">
    <span style="font-size:22px">üë§</span>
    <div><div class="m-name">Creator Contacts</div><div class="m-sub">6 tracked creators</div></div>
    <button class="m-close" style="margin-left:auto" onclick="closeM('contacts')">‚úï</button>
  </div>
  <div class="m-body" id="contacts-body"></div>
</div></div>

<!-- TECHZILLA PROFILE -->
<div class="overlay" id="m-p-techzilla"><div class="modal">
  <div class="m-hd">
    <div class="m-av" style="background:#3b5bdb">TZ</div>
    <div><div class="m-name">TechZilla</div><div class="m-sub">@techzilla_hd ¬∑ X (Twitter)</div></div>
    <div class="m-stats"><div><div class="mstat-v">12</div><div class="mstat-l">Downloads</div></div><div><div class="mstat-v">4</div><div class="mstat-l">Pending</div></div></div>
    <button class="m-close" onclick="closeM('p-techzilla')">‚úï</button>
  </div>
  <div class="m-body" id="tz-jobs"></div>
</div></div>

<!-- NIGHTOWL PROFILE -->
<div class="overlay" id="m-p-nightowl"><div class="modal">
  <div class="m-hd">
    <div class="m-av" style="background:#c91a7c">NO</div>
    <div><div class="m-name">NightOwl</div><div class="m-sub">@nightowl.films ¬∑ TikTok</div></div>
    <div class="m-stats"><div><div class="mstat-v">8</div><div class="mstat-l">Downloads</div></div><div><div class="mstat-v">1</div><div class="mstat-l">Running</div></div></div>
    <button class="m-close" onclick="closeM('p-nightowl')">‚úï</button>
  </div>
  <div class="m-body" id="no-jobs"></div>
</div></div>

<div class="toast-box" id="toast-box"></div>

<script>
const JOBS=[
  {id:'j1',status:'queued',creator:'TechZilla',ck:'techzilla',plt:'x',em:'üñ•Ô∏è',title:'RTX 5090 Deep Dive Review',url:'https://x.com/techzilla/status/111',date:'2m ago',prog:null},
  {id:'j2',status:'queued',creator:'CodeCraft',ck:'codecraft',plt:'tiktok',em:'üíª',title:'Clean Code in 60 Seconds',url:'https://tiktok.com/@codecraft/video/222',date:'5m ago',prog:null},
  {id:'j3',status:'queued',creator:'VoxPop',ck:'voxpop',plt:'x',em:'üéôÔ∏è',title:'AI Interview: Linus Sebastian',url:'https://x.com/voxpop/status/333',date:'8m ago',prog:null},
  {id:'j4',status:'running',creator:'NightOwl',ck:'nightowl',plt:'tiktok',em:'üé¨',title:'Studio Behind the Scenes',url:'https://tiktok.com/@nightowl/video/444',date:'1m ago',prog:62},
  {id:'j5',status:'running',creator:'DataDiver',ck:'datadiver',plt:'x',em:'üìä',title:'ML Pipeline Tutorial 2025',url:'https://x.com/datadiver/status/555',date:'3m ago',prog:28},
  {id:'j6',status:'completed',creator:'TechZilla',ck:'techzilla',plt:'x',em:'üñ•Ô∏è',title:'M4 Mac Mini Hands-on',url:'https://x.com/techzilla/status/666',date:'1h ago',prog:null},
  {id:'j7',status:'completed',creator:'CodeCraft',ck:'codecraft',plt:'tiktok',em:'üíª',title:'React 19 New Features',url:'https://tiktok.com/@codecraft/video/777',date:'2h ago',prog:null},
  {id:'j8',status:'completed',creator:'NightOwl',ck:'nightowl',plt:'tiktok',em:'üé¨',title:'Cinematic RAW Footage 4K',url:'https://tiktok.com/@nightowl/video/888',date:'3h ago',prog:null},
  {id:'j9',status:'completed',creator:'VoxPop',ck:'voxpop',plt:'x',em:'üéôÔ∏è',title:'Podcast: The AI Era',url:'https://x.com/voxpop/status/999',date:'4h ago',prog:null},
  {id:'j10',status:'completed',creator:'DataDiver',ck:'datadiver',plt:'x',em:'üìä',title:'Pandas vs Polars Bench',url:'https://x.com/datadiver/status/1000',date:'5h ago',prog:null},
  {id:'j11',status:'failed',creator:'TechZilla',ck:'techzilla',plt:'x',em:'üñ•Ô∏è',title:'Leaked Pixel 10 Specs',url:'https://x.com/techzilla/status/aaa',date:'30m ago',prog:null},
  {id:'j12',status:'failed',creator:'NightOwl',ck:'nightowl',plt:'tiktok',em:'üé¨',title:'LIVE: Premiere Night',url:'https://tiktok.com/@nightowl/video/bbb',date:'45m ago',prog:null},
];
const CONTACTS=[
  {k:'techzilla',name:'TechZilla',handle:'@techzilla_hd',plt:'X',clr:'#3b5bdb',ini:'TZ',dl:12,pend:1},
  {k:'nightowl',name:'NightOwl',handle:'@nightowl.films',plt:'TikTok',clr:'#c91a7c',ini:'NO',dl:8,pend:1},
  {k:'codecraft',name:'CodeCraft',handle:'@codecraft_dev',plt:'TikTok',clr:'#2f9e44',ini:'CC',dl:6,pend:0},
  {k:'voxpop',name:'VoxPop',handle:'@voxpop_media',plt:'X',clr:'#e67700',ini:'VP',dl:4,pend:0},
  {k:'datadiver',name:'DataDiver',handle:'@datadiver_ai',plt:'X',clr:'#7048e8',ini:'DD',dl:3,pend:1},
];
const EVENTS=[
  {t:'success',ic:'‚úÖ',tx:'Job j8 completed ‚Äî Cinematic RAW Footage (142 MB)',tm:'1m ago'},
  {t:'info',ic:'üîÑ',tx:'Job j4 progress: 62% ‚Äî HLS segment 31/50',tm:'2m ago'},
  {t:'info',ic:'üîÑ',tx:'Job j5 progress: 28% ‚Äî Playwright extracting URL‚Ä¶',tm:'3m ago'},
  {t:'error',ic:'‚ùå',tx:'Job j12 failed ‚Äî TikTok 403: Rate limit exceeded',tm:'10m ago'},
  {t:'warn',ic:'‚ö†Ô∏è',tx:'Job j11 failed ‚Äî X post unavailable (404)',tm:'12m ago'},
  {t:'info',ic:'üì•',tx:'Job j3 queued ‚Äî VoxPop interview detected (X)',tm:'8m ago'},
  {t:'success',ic:'‚úÖ',tx:'Job j9 completed ‚Äî Podcast AI Era (88 MB)',tm:'4h ago'},
  {t:'info',ic:'üåê',tx:'Playwright browser context initialized',tm:'4h ago'},
];

let jobs=[...JOBS], sel=new Set(), filter='all', view='kanban', drawerOpen=false, dragId=null, jid=200;

function mkCard(j){
  const d=document.createElement('div');
  d.className='jcard'+(sel.has(j.id)?' selected':'');
  d.id='c'+j.id; d.draggable=true;
  d.ondragstart=e=>{dragId=j.id;d.classList.add('dragging');e.dataTransfer.effectAllowed='move';};
  d.ondragend=()=>{d.classList.remove('dragging');dragId=null;};
  const prog=j.prog!==null?`<div class="prog-wrap"><div class="prog-fill" id="pf${j.id}" style="width:${j.prog}%"></div></div>`:'';
  let acts='';
  if(j.status==='failed') acts=`<div class="jacts"><button class="jact" onclick="retryJ('${j.id}')">‚Üª Retry</button><button class="jact danger" onclick="delJ('${j.id}')">Delete</button></div>`;
  else if(j.status==='completed') acts=`<div class="jacts"><button class="jact" onclick="showToast('Downloading‚Ä¶','info')">‚¨á Save</button><button class="jact danger" onclick="delJ('${j.id}')">Delete</button></div>`;
  else acts=`<div class="jacts"><button class="jact danger" onclick="delJ('${j.id}')">Delete</button></div>`;
  d.innerHTML=`<div class="jcard-top"><div class="jthumbl">${j.em}</div><div class="jinfo"><div class="jcreator">${j.creator}</div><div class="jtitle">${j.title}</div><div class="jurl">${j.url.replace('https://','')}</div></div><div class="jchk" onclick="togSel(event,'${j.id}')"></div></div><div class="jmeta"><span class="pbadge ${j.plt}">${j.plt==='x'?'ùïè X':'‚ô™ TikTok'}</span><span class="jtime">${j.date}</span></div>${prog}${acts}`;
  return d;
}

function renderBoard(){
  const fj=filter==='all'?jobs:jobs.filter(j=>j.ck===filter);
  ['queued','running','completed','failed'].forEach(s=>{
    const c=document.getElementById('jobs-'+s); if(!c) return;
    c.innerHTML='';
    fj.filter(j=>j.status===s).forEach(j=>c.appendChild(mkCard(j)));
    const el=document.getElementById('cnt-'+s); if(el) el.textContent=fj.filter(j=>j.status===s).length;
  });
}

function renderSwimlane(){
  const board=document.getElementById('board');
  board.className='board swimlane'; board.innerHTML='';
  const keys=filter==='all'?[...new Set(jobs.map(j=>j.ck))]:[filter];
  keys.forEach(k=>{
    const ct=CONTACTS.find(c=>c.k===k); if(!ct) return;
    const cj=jobs.filter(j=>j.ck===k); if(!cj.length) return;
    const row=document.createElement('div'); row.className='swim-row';
    const stList=['queued','running','completed','failed'];
    const lbls=stList.map(s=>`<div class="swim-col-lbl">${s}</div>`).join('');
    row.innerHTML=`<div class="swim-hd"><div class="swim-av" style="background:${ct.clr}">${ct.ini}</div><div><div class="swim-name">${ct.name}</div><div class="swim-sub">${ct.handle}</div></div><div class="swim-cnt">${cj.length} jobs</div></div><div class="swim-cols-hd">${lbls}</div><div class="swim-cols" id="sw${k}"></div>`;
    board.appendChild(row);
    const sc=row.querySelector('#sw'+k);
    stList.forEach(s=>{
      const col=document.createElement('div'); col.className='swim-col';
      const sj=cj.filter(j=>j.status===s);
      if(sj.length) sj.forEach(j=>{const m=document.createElement('div');m.className='swim-mini';m.innerHTML=`<span style="margin-right:3px">${j.em}</span><strong>${j.creator}</strong><div style="color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:9px">${j.title}</div>`;col.appendChild(m);});
      else col.innerHTML='<div class="swim-empty">‚Äî</div>';
      sc.appendChild(col);
    });
  });
}

function setView(v){
  view=v;
  document.getElementById('vk').classList.toggle('active',v==='kanban');
  document.getElementById('vs').classList.toggle('active',v==='swimlane');
  if(v==='kanban'){
    const b=document.getElementById('board');
    b.className='board'; b.innerHTML=`
      <div class="col queued" id="col-queued" ondragover="dov(event)" ondrop="dop(event,'queued')">
        <div class="col-hd"><div class="col-dot"></div><span class="col-title">Queued</span><span class="col-cnt" id="cnt-queued">0</span></div>
        <div class="add-area"><input class="add-inp" id="url-inp" type="text" placeholder="Paste X or TikTok URL‚Ä¶" onkeydown="if(event.key==='Enter')addJob()"><button class="add-sub" onclick="addJob()">+</button></div>
        <div class="col-body" id="jobs-queued"></div>
      </div>
      <div class="col running" id="col-running" ondragover="dov(event)" ondrop="dop(event,'running')">
        <div class="col-hd"><div class="col-dot"></div><span class="col-title">Running</span><span class="col-cnt" id="cnt-running">0</span></div>
        <div class="col-body" id="jobs-running"></div>
      </div>
      <div class="col completed" id="col-completed" ondragover="dov(event)" ondrop="dop(event,'completed')">
        <div class="col-hd"><div class="col-dot"></div><span class="col-title">Completed</span><span class="col-cnt" id="cnt-completed">0</span></div>
        <div class="col-body" id="jobs-completed"></div>
      </div>
      <div class="col failed" id="col-failed" ondragover="dov(event)" ondrop="dop(event,'failed')">
        <div class="col-hd"><div class="col-dot"></div><span class="col-title">Failed</span><span class="col-cnt" id="cnt-failed">0</span></div>
        <div class="col-body" id="jobs-failed"></div>
      </div>`;
    renderBoard();
  } else renderSwimlane();
  showToast(v==='swimlane'?'Swimlane view ‚Äî grouped by creator':'Kanban view ‚Äî grouped by status','info');
}

function dov(e){e.preventDefault();e.currentTarget.classList.add('drag-over');}
document.addEventListener('dragleave',e=>{const c=e.target.closest('.col');if(c)c.classList.remove('drag-over');});
function dop(e,ns){
  e.preventDefault();
  document.querySelectorAll('.col').forEach(c=>c.classList.remove('drag-over'));
  if(!dragId) return;
  const j=jobs.find(x=>x.id===dragId); if(!j||j.status===ns) return;
  const old=j.status; j.status=ns;
  if(ns==='running') j.prog=0; else j.prog=null;
  renderBoard();
  showToast(`Moved "${j.title}" ‚Üí ${ns}`,'info');
  addEvent({t:'info',ic:'üîÑ',tx:`Job moved: ${j.title} (${old} ‚Üí ${ns})`,tm:'just now'});
}

function addJob(){
  const inp=document.getElementById('url-inp'); if(!inp) return;
  const url=inp.value.trim();
  if(!url){inp.focus();inp.style.borderColor='#c92a2a';setTimeout(()=>inp.style.borderColor='',1000);return;}
  const isX=url.includes('x.com')||url.includes('twitter.com');
  const isTT=url.includes('tiktok.com');
  if(!isX&&!isTT){showToast('Only X and TikTok URLs supported','error');inp.style.borderColor='#c92a2a';setTimeout(()=>inp.style.borderColor='',1000);return;}
  const nj={id:'j'+(++jid),status:'queued',creator:isX?'X Creator':'TikTok Creator',ck:isX?'voxpop':'codecraft',plt:isX?'x':'tiktok',em:isX?'ùïè':'‚ô™',title:'New Download',url,date:'just now',prog:null};
  jobs.unshift(nj); inp.value=''; renderBoard();
  showToast('Job queued!','success');
  addEvent({t:'info',ic:'üì•',tx:`Job queued: ${url.substring(0,48)}‚Ä¶`,tm:'just now'});
}

function delJ(id){jobs=jobs.filter(j=>j.id!==id);sel.delete(id);renderBoard();updBulk();showToast('Job deleted','info');}
function retryJ(id){const j=jobs.find(x=>x.id===id);if(!j)return;j.status='queued';j.prog=null;renderBoard();showToast(`Retrying "${j.title}"`,'info');addEvent({t:'info',ic:'‚Üª',tx:`Retry: ${j.title}`,tm:'just now'});}

function togSel(e,id){e.stopPropagation();sel.has(id)?sel.delete(id):sel.add(id);const c=document.getElementById('c'+id);if(c)c.classList.toggle('selected',sel.has(id));updBulk();}
function updBulk(){const b=document.getElementById('bulk-bar');document.getElementById('bcnt').textContent=sel.size+' selected';b.classList.toggle('on',sel.size>0);}
function clearSel(){sel.clear();document.querySelectorAll('.jcard.selected').forEach(c=>c.classList.remove('selected'));updBulk();}
function bulkDel(){const n=sel.size;jobs=jobs.filter(j=>!sel.has(j.id));sel.clear();renderBoard();updBulk();showToast(`Deleted ${n} jobs`,'info');}
function bulkRetry(){let n=0;sel.forEach(id=>{const j=jobs.find(x=>x.id===id&&x.status==='failed');if(j){j.status='queued';j.prog=null;n++;}});clearSel();renderBoard();showToast(n?`Retrying ${n} jobs`:'No failed jobs selected',n?'success':'info');}

function filterBy(k,el){filter=k;document.querySelectorAll('.chip').forEach(c=>c.classList.remove('active'));el.classList.add('active');view==='kanban'?renderBoard():renderSwimlane();}

function toggleDrawer(){drawerOpen=!drawerOpen;document.getElementById('drawer').classList.toggle('open',drawerOpen);if(drawerOpen)document.getElementById('dbadge').style.display='none';}
function addEvent(ev){EVENTS.unshift(ev);renderEvents();if(!drawerOpen){const b=document.getElementById('dbadge');b.style.display='flex';b.textContent=Math.min(parseInt(b.textContent||0)+1,99);}}
function renderEvents(){
  const f=document.getElementById('activity-feed'); f.innerHTML='';
  EVENTS.slice(0,20).forEach(e=>{const d=document.createElement('div');d.className='aitem';d.innerHTML=`<div class="aico ${e.t}"><span>${e.ic}</span></div><div><div class="atxt">${e.tx}</div><div class="atme">${e.tm}</div></div>`;f.appendChild(d);});
}

function openM(id){document.getElementById('m-'+id).classList.add('open');}
function closeM(id){document.getElementById('m-'+id).classList.remove('open');}
document.addEventListener('click',e=>{document.querySelectorAll('.overlay.open').forEach(o=>{if(e.target===o)closeM(o.id.replace('m-',''));});});
function focusAdd(){const i=document.getElementById('url-inp');if(i){i.scrollIntoView({behavior:'smooth',block:'center'});i.focus();}}

function renderContacts(){
  const b=document.getElementById('contacts-body'); b.innerHTML='';
  CONTACTS.forEach(c=>{
    const d=document.createElement('div');
    d.innerHTML=`<div style="display:flex;align-items:center;gap:10px;padding:9px 0;border-bottom:1px solid var(--border);cursor:pointer" onclick="closeM('contacts');openM('p-${c.k}')"><div style="width:38px;height:38px;border-radius:50%;background:${c.clr};display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:13px;flex-shrink:0">${c.ini}</div><div style="flex:1"><div style="font-weight:700;font-size:13px">${c.name}</div><div style="font-size:11px;color:var(--muted)">${c.handle} ¬∑ ${c.plt}</div></div><div style="text-align:right"><div style="font-size:15px;font-weight:800;color:var(--accent)">${c.dl}</div><div style="font-size:9px;color:var(--muted)">downloads</div></div><span style="color:var(--muted);font-size:14px">‚Ä∫</span></div>`;
    b.appendChild(d);
  });
}

function renderProfile(k,cid){
  const c=document.getElementById(cid); if(!c) return;
  const pj=jobs.filter(j=>j.ck===k); c.innerHTML='';
  pj.forEach(j=>{const d=document.createElement('div');d.className='mjrow';d.innerHTML=`<div class="mjth">${j.em}</div><div class="mjinf"><div class="mjtitle">${j.title}</div><div class="mjdate">${j.url.replace('https://','').substring(0,38)} ¬∑ ${j.date}</div></div><span class="spill ${j.status}">${j.status}</span>`;c.appendChild(d);});
  if(!pj.length) c.innerHTML='<div style="text-align:center;padding:24px;color:var(--muted)">No jobs yet</div>';
}

function showToast(msg,type='info'){
  const b=document.getElementById('toast-box');
  const t=document.createElement('div'); t.className='toast '+type;
  t.innerHTML=`<span>${{success:'‚úì',error:'‚úï',info:'‚Ñπ'}[type]||'‚Ä¢'}</span> ${msg}`;
  b.appendChild(t);
  setTimeout(()=>{t.style.opacity='0';t.style.transform='translateX(36px)';t.style.transition='all .3s';setTimeout(()=>t.remove(),300);},3000);
}

function simProgress(){
  let ch=false;
  jobs.forEach(j=>{
    if(j.status==='running'&&j.prog!==null){
      j.prog=Math.min(j.prog+Math.random()*7,100);
      if(j.prog>=100){j.status='completed';j.prog=null;showToast(`"${j.title}" completed!`,'success');addEvent({t:'success',ic:'‚úÖ',tx:`Completed: ${j.title}`,tm:'just now'});}
      ch=true;
    }
  });
  const qd=jobs.filter(j=>j.status==='queued'), rn=jobs.filter(j=>j.status==='running');
  if(rn.length<2&&qd.length>0&&Math.random()>.65){const nx=qd[0];nx.status='running';nx.prog=0;ch=true;addEvent({t:'info',ic:'üîÑ',tx:`Started: ${nx.title}`,tm:'just now'});}
  if(ch&&view==='kanban') renderBoard();
}

document.addEventListener('DOMContentLoaded',()=>{
  renderBoard(); renderEvents(); renderContacts();
  renderProfile('techzilla','tz-jobs'); renderProfile('nightowl','no-jobs');
  setInterval(simProgress,2000);
  setInterval(()=>{jobs.forEach(j=>{const c=document.getElementById('c'+j.id);if(c&&j.status==='running'){const b=c.querySelector('[id^="pf"]');if(b)b.style.width=(j.prog||0)+'%';}});},500);
});
</script>
</body>
</html>
